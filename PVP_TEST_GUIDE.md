# 🎮 PvP 멀티플레이 테스트 가이드

## ✅ 준비사항

### 1. 백엔드 서버 실행 (필수!)

PvP 모드를 사용하려면 반드시 Socket.IO 백엔드 서버가 실행되어 있어야 합니다.

#### 옵션 A: 프론트엔드 + 백엔드 동시 실행 (권장)

```powershell
npm run dev:full
```

이 명령은 자동으로:
- 프론트엔드: `http://localhost:5173`
- 백엔드 서버: `http://localhost:3001`

두 개를 동시에 실행합니다.

#### 옵션 B: 백엔드만 별도 실행

터미널 1:
```powershell
npm run server
```

터미널 2:
```powershell
npm run dev
```

---

## 🧪 혼자서 PvP 테스트하는 방법

### 방법 1: 일반 모드 + 시크릿 모드

1. **일반 브라우저 창**에서 `http://localhost:5173` 접속
   - 메인 화면 → "멀티플레이 (PvP)" 클릭
   - 닉네임: `플레이어1`, 방 이름: `테스트방` 입력
   - "방 생성" 클릭

2. **시크릿/프라이빗 브라우저 창**을 새로 열고 `http://localhost:5173` 접속
   - 메인 화면 → "멀티플레이 (PvP)" 클릭
   - 닉네임: `플레이어2` 입력
   - "테스트방" 옆의 "참가하기" 클릭

3. 두 창에서 각각 **"준비 완료"** 버튼 클릭

4. 자동으로 게임 시작! ✅

---

### 방법 2: 다른 브라우저 사용

- **Chrome**에서 플레이어1
- **Edge** 또는 **Firefox**에서 플레이어2

같은 방식으로 진행

---

### 방법 3: 다른 기기에서 테스트

같은 Wi-Fi에 연결된 다른 PC/노트북이 있다면:

1. 서버를 실행한 PC의 **로컬 IP 주소** 확인:
   ```powershell
   ipconfig
   ```
   예: `192.168.0.100`

2. `src/hooks/useSocket.ts` 파일 수정:
   ```typescript
   const SERVER_URL = 'http://192.168.0.100:3001'; // 자신의 IP로 변경
   ```

3. 다른 기기에서 `http://192.168.0.100:5173` 접속

---

## 🔍 연결 상태 확인

### 정상 연결 시

멀티플레이 로비 화면에서:
- 🟢 **서버 연결됨** (녹색 점)
- 방 생성 버튼 활성화

### 연결 실패 시

- 🔴 **서버 연결 안됨** (빨간색 점)
- 노란색 경고 박스:
  ```
  ⚠️ 백엔드 서버 연결 필요
  npm run server
  ```

**해결 방법**: 백엔드 서버를 실행하지 않았다면 `npm run server` 또는 `npm run dev:full` 실행

---

## 🎯 PvP 게임 플레이 플로우

### 1. 방 생성 (플레이어1)
- 닉네임 입력
- 방 이름 입력
- "방 생성" 클릭
- 대기실로 이동

### 2. 방 참가 (플레이어2)
- 닉네임 입력
- 방 목록에서 원하는 방의 "참가하기" 클릭
- 같은 대기실로 이동

### 3. 준비
- 두 플레이어 모두 "준비 완료" 버튼 클릭
- 자동으로 게임 시작

### 4. 전투 (현재 구현 중)
- 호스트가 선공
- 턴제로 진행
- Socket.IO로 실시간 동기화

---

## 🐛 문제 해결

### "방 생성" 버튼이 비활성화되어 있어요

**원인**: 백엔드 서버가 실행되지 않음

**해결**:
```powershell
npm run server
```

또는

```powershell
npm run dev:full
```

---

### "서버에 연결할 수 없습니다" 에러

**원인**: 백엔드 서버가 3001 포트에서 실행되지 않음

**확인**:
1. 터미널에서 백엔드 서버 실행 여부 확인
2. `http://localhost:3001/api/health` 접속 시 `{"status":"ok"}` 응답이 와야 함

---

### 방을 만들었는데 다른 창에서 안 보여요

**원인**: 
- 서버가 재시작되었거나
- 브라우저 캐시 문제

**해결**:
1. 두 창 모두 새로고침 (F5)
2. 백엔드 서버 재시작

---

### 시크릿 모드에서도 같은 플레이어로 인식돼요

**원인**: Socket.IO가 같은 브라우저 세션으로 인식

**해결**:
- 다른 브라우저 사용 (Chrome vs Edge)
- 또는 PC 2대 사용

---

## 📌 백엔드 서버 로그 확인

백엔드 서버를 실행하면 다음과 같은 로그가 표시됩니다:

```
  ========================================
  🎮 Financial Card Storm 멀티플레이 서버
  ========================================
  포트: 3001
  Socket.IO: 활성화
  CORS: http://localhost:5173
  ========================================

[Socket.IO] 클라이언트 접속: abc123xyz
[방 생성] room-1234567890 - 테스트방 by 플레이어1
[방 참가] 플레이어2 -> 테스트방
[게임 시작] 테스트방
```

이 로그가 보이면 정상 작동 중입니다! ✅

---

## 🚀 빠른 테스트 스크립트

### Windows (PowerShell)

터미널 1:
```powershell
npm run dev:full
```

이후 브라우저에서:
1. 일반 창: `http://localhost:5173`
2. Ctrl + Shift + N (Chrome 시크릿 모드)
3. 두 창에서 각각 방 생성/참가

---

## 💡 팁

1. **빠른 테스트**: `npm run dev:full` 한 번만 실행하면 끝
2. **로그 확인**: 백엔드 터미널에서 실시간 이벤트 확인 가능
3. **디버깅**: 브라우저 개발자 도구 콘솔에서 Socket.IO 연결 상태 확인
4. **포트 변경**: `server/index.ts`와 `src/hooks/useSocket.ts`에서 포트 수정 가능

---

**즐거운 PvP 테스트 되세요! ⚔️🎮**





